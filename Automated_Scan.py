import schedule
import time
from Open_Ports_Scanning import scan_open_ports
from Open_Ports_Scanning import target
from Outdated_Software_Detection import check_outdated_software
from Outdated_Software_Detection import software_list
from Configuration_Checks import check_common_misconfigurations
from Report_Generation import generate_report


def automated_scan():
    open_ports = scan_open_ports(target)
    outdated = check_outdated_software(software_list)
    config_issues = check_common_misconfigurations()
    generate_report(open_ports, outdated, config_issues)


schedule.every().day.at("02:00").do(automated_scan)

while True:
    schedule.run_pending()
    time.sleep(60)
