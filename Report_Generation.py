import pandas as pd
from reportlab.lib.pagesizes import letter
from reportlab.pdfgen import canvas
import Open_Ports_Scanning,Outdated_Software_Detection,Configuration_Checks

def generate_report(open_ports, outdated_software, config_issues, report_file='report.pdf'):
    data = {
        "Open Ports": open_ports,
        "Outdated Software": outdated_software,
        "Configuration Issues": config_issues
    }

    df = pd.DataFrame(dict([(k,pd.Series(v)) for k,v in data.items()]))  # Handle different lengths

    c = canvas.Canvas(report_file, pagesize=letter)
    text = c.beginText(40, 750)
    text.setFont("Helvetica", 12)

    for column in df.columns:
        text.textLine(f'{column}:')
        for item in df[column].dropna():
            text.textLine(f'  - {item}')
        text.textLine('')

    c.drawText(text)
    c.showPage()
    c.save()


open_ports=Open_Ports_Scanning
outdated=Outdated_Software_Detection
config_issues=Configuration_Checks
generate_report(open_ports, outdated, config_issues, report_file='metasploit_scan_report.pdf')
