import tkinter as tk
from tkinter import messagebox
from Open_Ports_Scanning import scan_open_ports
from Open_Ports_Scanning import target
from Outdated_Software_Detection import check_outdated_software
from Outdated_Software_Detection import software_list
from Configuration_Checks import check_common_misconfigurations
from Report_Generation import generate_report


def start_scan():
    #target = entry_target.get()
    open_ports = scan_open_ports(target)
    outdated = check_outdated_software(software_list)
    config_issues = check_common_misconfigurations()
    generate_report(open_ports, outdated, config_issues)
    messagebox.showinfo("Scan Complete", "Scan and report generation complete.")


root = tk.Tk()
root.title("Vulnerability Scanner")

tk.Label(root, text="Target (IP or URL):").grid(row=0, column=0)
entry_target = tk.Entry(root)
entry_target.grid(row=0, column=1)

tk.Button(root, text="Start Scan", command=start_scan).grid(row=1, column=0, columnspan=2)

root.mainloop()
